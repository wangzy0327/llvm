/*===------- __clang_bang_math_tables.h - Device-side MLU math tables ------===
 *
 * Copyright (C) [2020] by Cambricon, Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 *===-----------------------------------------------------------------------===
 */

#ifndef __CLANG_BANG_MATH_TABLES_H__
#define __CLANG_BANG_MATH_TABLES_H__

#define W50 (8.881784197001252323e-16)
static __mlu_const__ float __bang_math_expf_de[357] = {
  -24173893*W50, -26070212*W50, 38831414*W50, -27132088*W50,
  -43020082*W50, -17489010*W50, 40854781*W50, 29735899*W50,
  34732307*W50, -45967856*W50, -33884221*W50, -30912696*W50,
  -45364151*W50, 7126397*W50, 25356821*W50, 1162997*W50,
  18514933*W50, -23100633*W50, -39975855*W50, -40619149*W50,
  -33489412*W50, -26996208*W50, -29499964*W50, 41523367*W50,
  -4037236*W50, 7098574*W50, -24069481*W50, -15529326*W50,
  24122884*W50, -3436401*W50, -16576187*W50, -23744637*W50,
  -33340626*W50, 35364676*W50, -4260638*W50, 17515355*W50,
  3411424*W50, 33658671*W50, 11420634*W50, 16680940*W50,
  40914803*W50, -12050546*W50, 24925355*W50, -31758793*W50,
  -15548783*W50, -22249844*W50, 26753203*W50, 36094423*W50,
  -2358649*W50, -10352471*W50, 3571027*W50, 30919567*W50,
  -22583208*W50, 6503717*W50, 23834521*W50, 21113616*W50,
  -9905892*W50, 7577009*W50, -19918864*W50, -15826470*W50,
  11305524*W50, -31359798*W50, 16568496*W50, -21821745*W50,
  13300560*W50, 29459849*W50, 18402655*W50, -28075965*W50,
  -34939889*W50, -10784548*W50, 35844487*W50, 13744627*W50,
  -2501107*W50, -21290803*W50, 31250042*W50, -17786095*W50,
  -12363414*W50, 38835790*W50, -35987835*W50, -187923*W50,
  -25306379*W50, -38244087*W50, 33512608*W50, 19522424*W50,
  -7444444*W50, 24799868*W50, 27226205*W50, -8355329*W50,
  -10080692*W50, 13488269*W50, -25854308*W50, 22971991*W50,
  -7678667*W50, 32750632*W50, -22667040*W50, -23896612*W50,
  20381277*W50, 22924589*W50, -24386956*W50, 26984617*W50,
  11793458*W50, 64382*W50, -16586774*W50, 31200607*W50,
  -20402843*W50, -24394267*W50, 10584148*W50, -1150850*W50,
  9250398*W50, 33294381*W50, -14103681*W50, 12092431*W50,
  26746459*W50, 21561596*W50, -11710269*W50, -5372811*W50,
  31978418*W50, 16197696*W50, 14684063*W50, 18990113*W50,
  20717724*W50, 11517869*W50, -16909578*W50, 1903235*W50,
  -15257441*W50, -2117351*W50, 32782256*W50, 6811992*W50,
  -14043165*W50, 35671828*W50, -229287*W50, 17511721*W50,
  6799869*W50, 32711502*W50, 13537196*W50, 14164900*W50,
  26114845*W50, -31747166*W50, -22252723*W50, -26579916*W50,
  19267070*W50, 34492455*W50, 10910892*W50, 12242115*W50,
  29976489*W50, -15922763*W50, 9426596*W50, 25946331*W50,
  25323768*W50, -705009*W50, 10525737*W50, -20308651*W50,
  -30721393*W50, -29195750*W50, -24165557*W50, -24015419*W50,
  32974397*W50, -1730105*W50, 3607447*W50, -29257026*W50,
  30556204*W50, -33982537*W50, -22792709*W50, -13784962*W50,
  -15310724*W50, 33162107*W50, -14423806*W50, -28738285*W50,
  -18339617*W50, 8263626*W50, -25553275*W50, 8264318*W50,
  33056889*W50, -27254623*W50, 22369209*W50, -29588221*W50,
  11217629*W50, 1400150*W50, 0*W50, -1396054*W50,
  -11152093*W50, -37583236*W50, 44217404*W50, -40574266*W50,
  -34039993*W50, 54922528*W50, -46807102*W50, 49159412*W50,
  -61563249*W50, 7964333*W50, -13892930*W50, -4112211*W50,
  28757468*W50, -54125839*W50, -272435*W50, 51319689*W50,
  -37282028*W50, -14965054*W50, -19817655*W50, -60045119*W50,
  -15231677*W50, -22560581*W50, 37980261*W50, 29808022*W50,
  -55039841*W50, 30167979*W50, 21923350*W50, 39235105*W50,
  -52989704*W50, -9809380*W50, 33534555*W50, -57163286*W50,
  -38294185*W50, -44211811*W50, 41969322*W50, -38375047*W50,
  -43401311*W50, 18086492*W50, 13203891*W50, 57863518*W50,
  19764193*W50, 14431675*W50, 33310522*W50, -55029790*W50,
  -12956053*W50, 27959717*W50, 59359749*W50, -49032972*W50,
  60425996*W50, 13620583*W50, 45611404*W50, 26554663*W50,
  -51615264*W50, 44178211*W50, -56382392*W50, -281133*W50,
  -36483869*W50, -53205890*W50, -58924888*W50, 57073636*W50,
  47892554*W50, 24577522*W50, -21152691*W50, 20684931*W50,
  23229299*W50, -21654127*W50, -4526855*W50, -51411085*W50,
  -53229599*W50, -18609733*W50, 43871162*W50, 9302683*W50,
  -13956101*W50, -34335071*W50, 55488021*W50, 15549952*W50,
  -46502971*W50, -23877961*W50, -40236565*W50, 10863586*W50,
  6308794*W50, 52191988*W50, 25944800*W50, 33311701*W50,
  -47732862*W50, 1451728*W50, -54305310*W50, 2849938*W50,
  51311059*W50, -29598127*W50, -23198741*W50, -50289301*W50,
  -7332003*W50, -14588592*W50, 31140709*W50, 10128462*W50,
  25237355*W50, -42728220*W50, 19162762*W50, -18591262*W50,
  -53797723*W50, 14924311*W50, -40487826*W50, -9009212*W50,
  -8630156*W50, -47533043*W50, -25159175*W50, 49769123*W50,
  -47958257*W50, -1522122*W50, -35823263*W50, -51117130*W50,
  51547854*W50, 48683489*W50, 39549965*W50, 15819941*W50,
  -30785108*W50, -2112545*W50, -13141520*W50, 33963757*W50,
  24738020*W50, -48853600*W50, 15899110*W50, -463189*W50,
  -892503*W50, 6154015*W50, 12268540*W50, 9092375*W50,
  -11684238*W50, 45595878*W50, -35318867*W50, 48554891*W50,
  -22043825*W50, -48356841*W50, -39006651*W50, -2565790*W50,
  -50064115*W50, 15239411*W50, -19893970*W50, 40575301*W50,
  -15694832*W50, 6636068*W50, -2568385*W50, 49627248*W50,
  -47336160*W50, 1212733*W50, -14989684*W50, -3600718*W50,
  26854234*W50, -32037778*W50, 11366121*W50, 48556200*W50,
  -28149020*W50, -28128479*W50, 39805500*W50, -30654377*W50,
  48677491*W50, -26602276*W50, 30633742*W50, 15238265*W50,
  17084682*W50, 27708170*W50, 38693257*W50, 41673633*W50,
  28331959*W50, -9600328*W50, 16330197*W50, 901295*W50,
  32287210*W50, 5741395*W50, 9159617*W50, 34002706*W50,
  -23765983*W50, 18694152*W50, -37916246*W50, -11403980*W50,
  -5422618*W50
};

#undef W50

static __mlu_const__ float __bang_math_expf_ae[357] = {
  0.706341624260, 0.707722544670, 0.709106206894, 0.710492491722,
  0.711881518364, 0.713273286819, 0.714667797089, 0.716064989567,
  0.717464923859, 0.718867540359, 0.720272958279, 0.721681118011,
  0.723092019558, 0.724505722523, 0.725922167301, 0.727341353893,
  0.728763341904, 0.730188071728, 0.731615602970, 0.733045935631,
  0.734479069710, 0.735915005207, 0.737353742123, 0.738795340061,
  0.740239679813, 0.741686880589, 0.743136882782, 0.744589745998,
  0.746045470238, 0.747503995895, 0.748965382576, 0.750429630280,
  0.751896739006, 0.753366768360, 0.754839599133, 0.756315350533,
  0.757793962955, 0.759275496006, 0.760759890079, 0.762247204781,
  0.763737440109, 0.765230536461, 0.766726613045, 0.768225550652,
  0.769727468491, 0.771232306957, 0.772740125656, 0.774250864983,
  0.775764524937, 0.777281165123, 0.778800785542, 0.780323386192,
  0.781848907471, 0.783377468586, 0.784909009933, 0.786443531513,
  0.787981033325, 0.789521574974, 0.791065096855, 0.792611658573,
  0.794161260128, 0.795713841915, 0.797269523144, 0.798828184605,
  0.800389945507, 0.801954746246, 0.803522586823, 0.805093467236,
  0.806667447090, 0.808244526386, 0.809824705124, 0.811407923698,
  0.812994241714, 0.814583659172, 0.816176235676, 0.817771852016,
  0.819370627403, 0.820972561836, 0.822577536106, 0.824185729027,
  0.825797021389, 0.827411472797, 0.829029142857, 0.830649912357,
  0.832273840904, 0.833900988102, 0.835531294346, 0.837164759636,
  0.838801443577, 0.840441346169, 0.842084407806, 0.843730747700,
  0.845380246639, 0.847033023834, 0.848688960075, 0.850348174572,
  0.852010667324, 0.853676378727, 0.855345308781, 0.857017576694,
  0.858693063259, 0.860371828079, 0.862053871155, 0.863739252090,
  0.865427851677, 0.867119789124, 0.868815064430, 0.870513617992,
  0.872215509415, 0.873920738697, 0.875629246235, 0.877341151237,
  0.879056394100, 0.880774974823, 0.882496893406, 0.884222209454,
  0.885950922966, 0.887682974339, 0.889418423176, 0.891157269478,
  0.892899513245, 0.894645154476, 0.896394193172, 0.898146688938,
  0.899902582169, 0.901661932468, 0.903424739838, 0.905190944672,
  0.906960606575, 0.908733785152, 0.910510361195, 0.912290453911,
  0.914074003696, 0.915861070156, 0.917651593685, 0.919445633888,
  0.921243190765, 0.923044204712, 0.924848794937, 0.926656901836,
  0.928468585014, 0.930283784866, 0.932102501392, 0.933924794197,
  0.935750663280, 0.937580049038, 0.939413070679, 0.941249668598,
  0.943089842796, 0.944933593273, 0.946780979633, 0.948631942272,
  0.950486540794, 0.952344775200, 0.954206645489, 0.956072151661,
  0.957941353321, 0.959814131260, 0.961690604687, 0.963570713997,
  0.965454578400, 0.967342019081, 0.969233214855, 0.971128106117,
  0.973026692867, 0.974929034710, 0.976835012436, 0.978744745255,
  0.980658233166, 0.982575476170, 0.984496414661, 0.986421167850,
  0.988349676132, 0.990281879902, 0.992217957973, 0.994157731533,
  0.996101379395, 0.998048782349, 1.000000000000, 1.001955032349,
  1.003913879395, 1.005876541138, 1.007843136787, 1.009813427925,
  1.011787652969, 1.013765811920, 1.015747666359, 1.017733573914,
  1.019723176956, 1.021716833115, 1.023714303970, 1.025715708733,
  1.027721047401, 1.029730200768, 1.031743407249, 1.033760547638,
  1.035781502724, 1.037806510925, 1.039835453033, 1.041868329048,
  1.043905258179, 1.045946121216, 1.047991037369, 1.050039887428,
  1.052092671394, 1.054149627686, 1.056210517883, 1.058275461197,
  1.060344338417, 1.062417387962, 1.064494490623, 1.066575527191,
  1.068660736084, 1.070749998093, 1.072843432426, 1.074940800667,
  1.077042341232, 1.079148054123, 1.081257820129, 1.083371758461,
  1.085489749908, 1.087611913681, 1.089738249779, 1.091868638992,
  1.094003319740, 1.096142172813, 1.098285198212, 1.100432276726,
  1.102583765984, 1.104739308357, 1.106899142265, 1.109063148499,
  1.111231327057, 1.113403916359, 1.115580558777, 1.117761611938,
  1.119946837425, 1.122136354446, 1.124330163002, 1.126528382301,
  1.128730773926, 1.130937457085, 1.133148431778, 1.135363817215,
  1.137583494186, 1.139807462692, 1.142035841942, 1.144268512726,
  1.146505594254, 1.148747086525, 1.150992989540, 1.153243184090,
  1.155497789383, 1.157756805420, 1.160020351410, 1.162288188934,
  1.164560437202, 1.166837215424, 1.169118404388, 1.171404123306,
  1.173694252968, 1.175988912582, 1.178287982941, 1.180591583252,
  1.182899594307, 1.185212254524, 1.187529325485, 1.189851045609,
  1.192177295685, 1.194507956505, 1.196843266487, 1.199183106422,
  1.201527595520, 1.203876614571, 1.206230282784, 1.208588480949,
  1.210951328278, 1.213318705559, 1.215690851212, 1.218067526817,
  1.220448851585, 1.222834944725, 1.225225567818, 1.227620959282,
  1.230020999908, 1.232425689697, 1.234835147858, 1.237249374390,
  1.239668130875, 1.242091774940, 1.244520068169, 1.246953129768,
  1.249391078949, 1.251833677292, 1.254281044006, 1.256733179092,
  1.259190082550, 1.261651873589, 1.264118432999, 1.266589879990,
  1.269066095352, 1.271547079086, 1.274033069611, 1.276523828506,
  1.279019474983, 1.281520009041, 1.284025430679, 1.286535739899,
  1.289050936699, 1.291571140289, 1.294096112251, 1.296626210213,
  1.299161076546, 1.301700949669, 1.304245829582, 1.306795716286,
  1.309350490570, 1.311910390854, 1.314475178719, 1.317045092583,
  1.319619894028, 1.322199821472, 1.324784755707, 1.327374815941,
  1.329969763756, 1.332569956779, 1.335175156593, 1.337785482407,
  1.340400934219, 1.343021392822, 1.345647096634, 1.348277926445,
  1.350913763046, 1.353554844856, 1.356201171875, 1.358852505684,
  1.361509203911, 1.364170908928, 1.366837978363, 1.369510173798,
  1.372187614441, 1.374870300293, 1.377558231354, 1.380251407623,
  1.382949829102, 1.385653495789, 1.388362526894, 1.391076803207,
  1.393796443939, 1.396521329880, 1.399251580238, 1.401987195015,
  1.404728055000, 1.407474398613, 1.410225987434, 1.412983059883,
  1.415745496750
};

// pi/2 with last 16 bits forced to 0
static __mlu_const__ float __bang_math_rem_pio2[] = {
  1.5703125000e+00,  // 0x3fc90000
  4.5776367188e-04,  // 0x39f00000
  2.5987625122e-05,  // 0x37da0000
  7.5437128544e-08,  // 0x33a20000
  6.0026650317e-11,  // 0x2e840000
  7.3896444519e-13,  // 0x2b500000
  5.3845816694e-15,  // 0x27c20000
  5.6378512969e-18,  // 0x22d00000
  8.3009228831e-20,  // 0x1fc40000
  3.2756352257e-22,  // 0x1bc60000
  6.3331015649e-25,  // 0x17440000
};

// Table of constants for 2/pi, 396 Hex digits (476 decimal) of 2/pi
static __mlu_const__  int32_t __bang_math_rem_ipio2[] = {
  0xA2, 0xF9, 0x83, 0x6E, 0x4E, 0x44, 0x15, 0x29, 0xFC,
  0x27, 0x57, 0xD1, 0xF5, 0x34, 0xDD, 0xC0, 0xDB, 0x62,
  0x95, 0x99, 0x3C, 0x43, 0x90, 0x41, 0xFE, 0x51, 0x63,
  0xAB, 0xDE, 0xBB, 0xC5, 0x61, 0xB7, 0x24, 0x6E, 0x3A,
  0x42, 0x4D, 0xD2, 0xE0, 0x06, 0x49, 0x2E, 0xEA, 0x09,
  0xD1, 0x92, 0x1C, 0xFE, 0x1D, 0xEB, 0x1C, 0xB1, 0x29,
  0xA7, 0x3E, 0xE8, 0x82, 0x35, 0xF5, 0x2E, 0xBB, 0x44,
  0x84, 0xE9, 0x9C, 0x70, 0x26, 0xB4, 0x5F, 0x7E, 0x41,
  0x39, 0x91, 0xD6, 0x39, 0x83, 0x53, 0x39, 0xF4, 0x9C,
  0x84, 0x5F, 0x8B, 0xBD, 0xF9, 0x28, 0x3B, 0x1F, 0xF8,
  0x97, 0xFF, 0xDE, 0x05, 0x98, 0x0F, 0xEF, 0x2F, 0x11,
  0x8B, 0x5A, 0x0A, 0x6D, 0x1F, 0x6D, 0x36, 0x7E, 0xCF,
  0x27, 0xCB, 0x09, 0xB7, 0x4F, 0x46, 0x3F, 0x66, 0x9E,
  0x5F, 0xEA, 0x2D, 0x75, 0x27, 0xBA, 0xC7, 0xEB, 0xE5,
  0xF1, 0x7B, 0x3D, 0x07, 0x39, 0xF7, 0x8A, 0x52, 0x92,
  0xEA, 0x6B, 0xFB, 0x5F, 0xB1, 0x1F, 0x8D, 0x5D, 0x08,
  0x56, 0x03, 0x30, 0x46, 0xFC, 0x7B, 0x6B, 0xAB, 0xF0,
  0xCF, 0xBC, 0x20, 0x9A, 0xF4, 0x36, 0x1D, 0xA9, 0xE3,
  0x91, 0x61, 0x5E, 0xE6, 0x1B, 0x08, 0x65, 0x99, 0x85,
  0x5F, 0x14, 0xA0, 0x68, 0x40, 0x8D, 0xFF, 0xD8, 0x80,
  0x4D, 0x73, 0x27, 0x31, 0x06, 0x06, 0x15, 0x56, 0xCA,
  0x73, 0xA8, 0xC9, 0x60, 0xE2, 0x7B, 0xC0, 0x8C, 0x6B,
};

// pi/2 with last 8 bits forced to 0
static __mlu_const__ int32_t __bang_math_rem_npio2_hw[] = {
  0x3fc90f00, 0x40490f00, 0x4096cb00, 0x40c90f00, 0x40fb5300, 0x4116cb00,
  0x412fed00, 0x41490f00, 0x41623100, 0x417b5300, 0x418a3a00, 0x4196cb00,
  0x41a35c00, 0x41afed00, 0x41bc7e00, 0x41c90f00, 0x41d5a000, 0x41e23100,
  0x41eec200, 0x41fb5300, 0x4203f200, 0x420a3a00, 0x42108300, 0x4216cb00,
  0x421d1400, 0x42235c00, 0x4229a500, 0x422fed00, 0x42363600, 0x423c7e00,
  0x4242c700, 0x42490f00
};

#endif  // __CLANG_BANG_MATH_TABLES_H__

